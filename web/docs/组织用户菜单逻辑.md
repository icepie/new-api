# 组织用户菜单逻辑说明

## 角色与组织定义

| 概念 | 条件 | 说明 |
|------|------|------|
| **超级管理员 (Root)** | `user.role >= 100` | 系统最高权限 |
| **系统/平台管理员** | `user.role >= 10` 且 `user.org_id === 0` | 管理整个平台 |
| **组织管理员 (OrgAdmin)** | `user.role === 10` 且 `user.org_id > 0` | 仅管理本组织 |
| **组织普通用户 (OrgUser)** | `user.org_id > 0`（任意 role） | 属于某组织，非管理员也是组织用户 |

---

## 侧边栏菜单逻辑

### 1. 个人中心（所有登录用户）

- **计费管理 / 钱包管理**（同一路径 `/console/topup`）
  - **组织用户**（`org_id > 0`）：文案「计费管理」，路由渲染 **Billing** 页
  - **非组织用户**（`org_id === 0`）：文案「钱包管理」，路由渲染 **TopUp** 页
- **个人设置**：所有人可见，路径 `/console/personal`

### 2. 管理员区域（仅 `role >= 10` 且 **无组织 id** 时显示）

- **带组织 id 的用户**（`org_id > 0`，含组织管理员）：**不显示**整个「管理员」区域。
- **仅系统/超级管理员**（`org_id === 0`）可见管理员区域。

| 菜单项 | 超级管理员 | 系统管理员 | 组织管理员（org_id>0） |
|--------|------------|------------|------------------------|
| 整个管理员区域 | ✅ | ✅ | ❌ 不显示 |
| 渠道管理 | ✅ | ❌ | — |
| 模型管理 | ✅ | ✅ | — |
| 模型部署 | ✅ | ✅ | — |
| 兑换码管理 | ✅ | ✅ | — |
| 用户管理 | ✅ | ✅ | — |
| 组织管理 | ✅ | ✅ | — |
| 系统设置 | ✅ | ❌ | — |

- **渠道管理、系统设置**：仅超级管理员（`isRoot()`）。
- **模型管理、模型部署、兑换码管理、组织管理**：系统/超级管理员可见（`isAdmin() && !isOrgAdmin`）。

---

## 路由与组件对应

- **路径**：`/console/topup`
- **组件**：`TopupBillingRoute`（根据 `user.org_id > 0` 渲染 `<Billing />` 或 `<TopUp />`）
- **入口**：侧栏「个人中心」同一菜单项，仅文案在「计费管理」与「钱包管理」间切换

---

## 相关文件与统一判断

| 文件 | 职责 |
|------|------|
| `web/src/components/layout/SiderBar.jsx` | 侧栏菜单项与可见性（financeItems / adminItems） |
| `web/src/components/routing/TopupBillingRoute.jsx` | `/console/topup` 按组织身份渲染 Billing / TopUp |
| `web/src/helpers/utils.jsx` | `isAdmin()`、`isRoot()`、`isOrgUser(user)`、`isOrgAdmin(user)` |
| `web/src/App.jsx` | `/console/topup` 使用 `PrivateRoute` + `TopupBillingRoute` |

**统一判断（推荐在侧栏、顶栏、个人设置、用户管理等处使用 helpers）：**

- `isOrgUser(user)`：`user && user.org_id > 0`
- `isOrgAdmin(user)`：`user && user.role === 10 && isOrgUser(user)`
